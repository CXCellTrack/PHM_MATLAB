-- 创建统计表 ST_AD_SL_NOISE 统计 AD_SL_NOISE 中的各个传感器数据

DROP TABLE ST_AD_SL_NOISE;
CREATE TABLE ST_AD_SL_NOISE AS
SELECT 
	DEVCODE,
	COUNT(DEVCODE) AS "count",
	ROUND(AVG(TO_NUMBER(DENSEDATA)), 3) AS "mean", --保留3位小数
	ROUND(VARIANCE(TO_NUMBER(DENSEDATA)), 3) AS "cov",
	MIN(TO_NUMBER(DENSEDATA)) AS "min",
	MAX(TO_NUMBER(DENSEDATA)) AS "max",
	MIN(UPTIME) AS "starttime",
	MAX(UPTIME) AS "endtime"
FROM
	AD_SL_NOISE
-- WHERE
--	 CELL!='0'
GROUP BY
	DEVCODE
ORDER BY
	DEVCODE;

exit;